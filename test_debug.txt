============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-9.0.1, pluggy-1.6.0 -- C:\Users\freex\.pyenv\pyenv-win\versions\3.11.9\python.exe
cachedir: .pytest_cache
rootdir: F:\Reversecore_MCP
configfile: pytest.ini
plugins: anyio-4.11.0, asyncio-1.3.0, cov-7.0.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 12 items

tests/unit/test_trinity_defense.py::TestTrinityDefense::test_discover_mode PASSED
tests/unit/test_trinity_defense.py::TestTrinityDefense::test_analyze_mode DEBUG FAILURE MESSAGE: Phase 2 (Neural Decompiler) failed: 'ToolSuccess' object has no attribute 'get'
FAILED
tests/unit/test_trinity_defense.py::TestTrinityDefense::test_full_mode_with_vaccine FAILED
tests/unit/test_trinity_defense.py::TestTrinityDefense::test_ghost_trace_failure PASSED
tests/unit/test_trinity_defense.py::TestTrinityDefense::test_no_threats_found PASSED
tests/unit/test_trinity_defense.py::TestTrinityDefense::test_max_threats_limit FAILED
tests/unit/test_trinity_defense.py::TestTrinityDefense::test_with_context_logging PASSED
tests/unit/test_trinity_defense.py::TestTrinityDefense::test_invalid_file_path PASSED
tests/unit/test_trinity_defense.py::TestTrinityDefense::test_full_mode_without_vaccine FAILED
tests/unit/test_trinity_defense.py::TestTrinityDefense::test_neural_decompile_failure PASSED
tests/unit/test_trinity_defense.py::TestTrinityDefense::test_vaccine_generation_failure PASSED
tests/unit/test_trinity_defense.py::TestRegisterTrinityDefense::test_register_trinity_defense PASSED
ERROR: Coverage failure: total of 13 is less than fail-under=80


================================== FAILURES ===================================
____________________ TestTrinityDefense.test_analyze_mode _____________________
tests\unit\test_trinity_defense.py:69: in test_analyze_mode
    assert result.status == "success"
E   AssertionError: assert 'error' == 'success'
E     
E     - success
E     + error
_______________ TestTrinityDefense.test_full_mode_with_vaccine ________________
tests\unit\test_trinity_defense.py:115: in test_full_mode_with_vaccine
    assert result.status == "success"
E   AssertionError: assert 'error' == 'success'
E     
E     - success
E     + error
__________________ TestTrinityDefense.test_max_threats_limit __________________
tests\unit\test_trinity_defense.py:194: in test_max_threats_limit
    assert result.status == "success"
E   AssertionError: assert 'error' == 'success'
E     
E     - success
E     + error
______________ TestTrinityDefense.test_full_mode_without_vaccine ______________
tests\unit\test_trinity_defense.py:263: in test_full_mode_without_vaccine
    assert result.status == "success"
E   AssertionError: assert 'error' == 'success'
E     
E     - success
E     + error
=============================== tests coverage ================================
_______________ coverage: platform win32, python 3.11.9-final-0 _______________

Name                                         Stmts   Miss  Cover   Missing
--------------------------------------------------------------------------
reversecore_mcp\__init__.py                      1      0   100%
reversecore_mcp\core\__init__.py                 9      0   100%
reversecore_mcp\core\binary_cache.py            72     52    28%   43, 53-90, 94-102, 106-120, 124-132
reversecore_mcp\core\command_spec.py            35     18    49%   46, 313-342, 362-366
reversecore_mcp\core\config.py                  71     21    70%   24, 30-31, 36, 96-105, 122-130, 135
reversecore_mcp\core\decorators.py              83     37    55%   61-63, 102-156
reversecore_mcp\core\error_formatting.py        44     39    11%   26-71, 84-93
reversecore_mcp\core\error_handling.py          48     48     0%   3-110
reversecore_mcp\core\exceptions.py              43     19    56%   16-21, 31-33, 43-45, 55-61, 71-72, 82
reversecore_mcp\core\execution.py               82     68    17%   26-32, 35-36, 39-40, 49-52, 86-169, 207-223
reversecore_mcp\core\ghidra_helper.py          189    171    10%   45-66, 76-80, 91-103, 126-228, 242-273, 283-292, 318-495
reversecore_mcp\core\json_utils.py              27     17    37%   35-37, 54-95, 105
reversecore_mcp\core\logging_config.py          49     39    20%   22-43, 57-118
reversecore_mcp\core\metrics.py                 86     64    26%   49-59, 63-64, 68-69, 73-74, 78-79, 87-90, 104-161
reversecore_mcp\core\r2_pool.py                 82     59    28%   16-17, 43-77, 81-98, 102, 106-114, 118-120, 124-126
reversecore_mcp\core\resilience.py              73     73     0%   8-125
reversecore_mcp\core\resource_manager.py        64     44    31%   34-39, 43-50, 54-61, 65-112
reversecore_mcp\core\result.py                  18      0   100%
reversecore_mcp\core\security.py                62     37    40%   52-55, 67-73, 109-156
reversecore_mcp\core\validators.py             115    115     0%   5-234
reversecore_mcp\prompts.py                      26     26     0%   1-255
reversecore_mcp\resources.py                   177    177     0%   1-363
reversecore_mcp\tools\__init__.py                0      0   100%
reversecore_mcp\tools\adaptive_vaccine.py      173    153    12%   28, 63-108, 113-139, 145-159, 173-223, 236-269, 288-356
reversecore_mcp\tools\cli_tools.py            1096   1096     0%   3-3519
reversecore_mcp\tools\ghost_trace.py           158    134    15%   29-66, 72-82, 90, 101-103, 137-206, 216-238, 243-304, 323-381
reversecore_mcp\tools\lib_tools.py             293    293     0%   4-609
reversecore_mcp\tools\neural_decompiler.py      66     52    21%   23, 48-70, 91-182
reversecore_mcp\tools\trinity_defense.py       175    118    33%   112-113, 122-123, 140, 147, 150-151, 164-182, 198-237, 267-345, 358-384, 396-554
--------------------------------------------------------------------------
TOTAL                                         3417   2970    13%
Coverage HTML written to dir htmlcov
FAIL Required test coverage of 80% not reached. Total coverage: 13.08%
=========================== short test summary info ===========================
FAILED tests/unit/test_trinity_defense.py::TestTrinityDefense::test_analyze_mode - AssertionError: assert 'error' == 'success'
  
  - success
  + error
FAILED tests/unit/test_trinity_defense.py::TestTrinityDefense::test_full_mode_with_vaccine - AssertionError: assert 'error' == 'success'
  
  - success
  + error
FAILED tests/unit/test_trinity_defense.py::TestTrinityDefense::test_max_threats_limit - AssertionError: assert 'error' == 'success'
  
  - success
  + error
FAILED tests/unit/test_trinity_defense.py::TestTrinityDefense::test_full_mode_without_vaccine - AssertionError: assert 'error' == 'success'
  
  - success
  + error
========================= 4 failed, 8 passed in 3.44s =========================
